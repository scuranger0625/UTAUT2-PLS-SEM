from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
import os

# 创建一个新的文档
doc = Document()

# 添加标题
doc.add_heading('SEM Results', level=1)

# 添加数据表格
data = [
    ["lval", "op", "rval", "Estimate", "Std. Err", "p-value", "t-value"],
    ["BI", "~", "PE", 1.066379, 0.278796, 0.00013, 3.82],
    ["BI", "~", "EE", -0.143884, 0.278266, 0.60511, -0.52],
    ["BI", "~", "SI", -0.420159, 0.355807, 0.23766, -1.18],
    ["BI", "~", "FC", 0.064230, 0.317688, 0.83978, 0.20],
    ["BI", "~", "HM", 0.185842, 0.238141, 0.43516, 0.78],
    ["BI", "~", "PV", 0.185705, 0.464584, 0.68936, 0.40],
    ["BI", "~", "HT", 0.155736, 0.463977, 0.73713, 0.34],
    ["BI", "~", "age", 1.084411, 0.454820, 0.01711, 2.38],
    ["BI", "~", "gender", -0.566516, 0.506049, 0.26293, -1.12],
    ["BI", "~", "age_PE", -2.372393, 0.621733, 0.00014, -3.82],
    ["BI", "~", "age_EE", 1.615392, 0.769034, 0.03568, 2.10],
    ["BI", "~", "age_SI", -0.724662, 0.747959, 0.33262, -0.97],
    ["BI", "~", "age_FC", 0.146900, 0.557322, 0.79210, 0.26],
    ["BI", "~", "age_HM", -0.911195, 0.809309, 0.26021, -1.13],
    ["BI", "~", "age_PV", -0.768638, 0.970537, 0.42838, -0.79],
    ["BI", "~", "age_HT", 1.893401, 0.899240, 0.03524, 2.11],
    ["BI", "~", "gender_PE", 0.403807, 0.620732, 0.51535, 0.65],
    ["BI", "~", "gender_EE", -1.630465, 0.621647, 0.00872, -2.62],
    ["BI", "~", "gender_SI", 0.605016, 0.466031, 0.19421, 1.30],
    ["BI", "~", "gender_FC", 0.950203, 0.745395, 0.20239, 1.27],
    ["BI", "~", "gender_HM", 0.826761, 0.581442, 0.15505, 1.42],
    ["BI", "~", "gender_PV", 0.105533, 0.618688, 0.86456, 0.17],
    ["BI", "~", "gender_HT", -0.663625, 0.364793, 0.06888, -1.82],
    ["PE", "~~", "age", 0.208398, 0.005518, 0.00000, 37.77],
    ["PE", "~~", "gender", -0.046171, 0.005286, 0.00000, -8.74],
    ["EE", "~~", "age", 0.079091, 0.004718, 0.00000, 16.76],
    ["EE", "~~", "gender", -0.021794, 0.004765, 0.00000, -4.57],
    ["SI", "~~", "age", 0.202009, 0.005163, 0.00000, 39.12],
    ["SI", "~~", "gender", -0.004834, 0.004945, 0.32836, -0.98],
    ["FC", "~~", "age", 0.051814, 0.005753, 0.00000, 9.01],
    ["FC", "~~", "gender", 0.056848, 0.005680, 0.00000, 10.01],
    ["HM", "~~", "age", 0.224573, 0.004910, 0.00000, 45.74],
    ["HM", "~~", "gender", 0.206845, 0.005672, 0.00000, 36.47],
    ["PV", "~~", "age", 0.234467, 0.005884, 0.00000, 39.85],
    ["PV", "~~", "gender", 0.120437, 0.005690, 0.00000, 21.17],
    ["HT", "~~", "age", 0.332979, 0.005102, 0.00000, 65.26],
    ["HT", "~~", "gender", 0.079970, 0.004726, 0.00000, 16.92],
    ["BI", "~~", "BI", 0.128150, 0.025377, 0.00000, 5.05]
]

table = doc.add_table(rows=1, cols=len(data[0]))

# 添加表头
hdr_cells = table.rows[0].cells
for i in range(len(data[0])):
    hdr_cells[i].text = data[0][i]

# 添加数据行
for i in range(1, len(data)):
    row_cells = table.add_row().cells
    for j in range(len(data[i])):
        if isinstance(data[i][j], float):
            row_cells[j].text = f"{data[i][j]:.3f}"  # 四舍五入至第三位
        else:
            row_cells[j].text = str(data[i][j])

# 获取桌面路径
desktop_path = os.path.join(os.path.expanduser('~'), 'Desktop')

# 保存文档至桌面
doc.save(os.path.join(desktop_path, 'SEM_Results.docx'))

print(f"文件已保存至桌面：{os.path.join(desktop_path, 'SEM_Results.docx')}")


