import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

PE1= [5, 3, 4, 2, 1, 2, 4, 4, 3, 5, 4, 4, 4, 5, 4, 4, 4, 3, 4, 4, 4, 4, 3, 5, 5, 4, 4, 4, 3, 4, 3, 5, 3, 4, 4, 4, 4, 3, 4, 5, 4, 5, 5, 3, 2, 4, 4, 4, 5, 5, 3]
PE2= [4, 3, 3, 3, 1, 2, 5, 3, 3, 5, 4, 3, 4, 5, 3, 4, 4, 4, 4, 4, 5, 3, 3, 5, 5, 4, 3, 5, 4, 5, 2, 5, 4, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 3, 2, 4, 4, 5, 5, 5, 2]
PE3= [5, 3, 4, 3, 1, 2, 4, 5, 3, 5, 4, 3, 5, 5, 4, 4, 4, 4, 3, 4, 4, 4, 3, 5, 4, 4, 3, 4, 4, 4, 2, 5, 4, 3, 3, 4, 4, 3, 3, 4, 4, 5, 5, 3, 4, 4, 2, 4, 5, 5, 3]
EE1= [4, 3, 3, 5, 5, 5, 4, 4, 5, 5, 4, 3, 3, 5, 3, 5, 5, 3, 3, 5, 4, 4, 3, 5, 5, 4, 4, 4, 5, 5, 4, 5, 3, 4, 4, 4, 4, 4, 4, 4, 3, 5, 5, 5, 4, 4, 5, 4, 5, 5, 4]
EE2= [4, 3, 3, 5, 5, 2, 4, 3, 5, 5, 4, 3, 3, 5, 4, 5, 5, 4, 4, 5, 5, 4, 3, 5, 5, 4, 3, 5, 4, 5, 4, 5, 4, 4, 3, 4, 4, 4, 4, 4, 4, 5, 5, 4, 4, 4, 5, 5, 5, 3, 4]
EE3= [4, 3, 2, 5, 5, 4, 4, 5, 5, 5, 4, 4, 3, 5, 4, 5, 5, 4, 4, 5, 4, 3, 3, 5, 5, 4, 4, 4, 5, 5, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 3, 5, 5, 4, 4, 4, 5, 4, 5, 5, 4]
EE4= [3, 3, 2, 5, 5, 3, 4, 4, 4, 5, 3, 3, 3, 5, 4, 5, 5, 2, 4, 5, 4, 3, 3, 5, 5, 4, 4, 5, 4, 5, 3, 5, 3, 4, 4, 4, 4, 2, 4, 5, 3, 5, 5, 4, 4, 4, 2, 4, 5, 5, 4]
SI1= [5, 3, 2, 3, 1, 1, 4, 3, 5, 5, 3, 2, 3, 5, 3, 4, 4, 2, 3, 3, 4, 4, 3, 5, 3, 2, 3, 4, 2, 3, 3, 5, 3, 4, 3, 3, 3, 3, 3, 4, 3, 5, 5, 1, 2, 3, 1, 5, 5, 4, 2]
SI2= [4, 3, 4, 3, 1, 4, 4, 3, 5, 5, 3, 2, 2, 5, 2, 4, 4, 4, 3, 3, 4, 3, 3, 5, 3, 3, 3, 4, 2, 3, 3, 5, 3, 4, 3, 3, 3, 2, 4, 4, 2, 4, 5, 1, 2, 3, 5, 4, 5, 4, 2]
SI3= [4, 3, 5, 3, 1, 1, 4, 3, 3, 3, 3, 3, 3, 5, 3, 4, 4, 2, 3, 3, 4, 3, 3, 5, 3, 2, 3, 5, 2, 2, 4, 5, 2, 3, 3, 3, 3, 3, 3, 4, 3, 4, 5, 1, 1, 3, 1, 3, 5, 2, 2]
FC1= [4, 3, 3, 4, 5, 3, 4, 4, 3, 5, 4, 4, 4, 5, 4, 5, 5, 4, 4, 4, 4, 3, 3, 5, 5, 4, 4, 4, 4, 5, 4, 5, 3, 4, 4, 4, 3, 3, 4, 4, 5, 5, 5, 4, 5, 4, 1, 4, 5, 5, 4]
FC2= [4, 3, 2, 5, 5, 2, 4, 4, 3, 5, 4, 4, 4, 5, 3, 5, 5, 2, 4, 4, 4, 4, 3, 5, 5, 4, 5, 4, 4, 5, 2, 5, 2, 4, 4, 4, 3, 2, 3, 4, 4, 5, 5, 4, 4, 4, 4, 4, 5, 3, 4]
FC3= [4, 3, 4, 4, 3, 4, 5, 4, 3, 5, 4, 4, 5, 5, 3, 4, 4, 3, 4, 3, 4, 4, 3, 5, 5, 4, 4, 5, 5, 5, 3, 5, 4, 4, 4, 4, 3, 1, 4, 4, 5, 5, 5, 2, 5, 4, 4, 5, 5, 4, 3]
FC4= [4, 3, 2, 3, 1, 2, 5, 4, 3, 5, 4, 4, 3, 5, 3, 4, 4, 2, 3, 4, 4, 4, 3, 5, 5, 4, 3, 4, 4, 3, 3, 5, 4, 4, 3, 2, 3, 2, 4, 4, 4, 5, 5, 2, 2, 4, 4, 4, 5, 3, 2]
HM1= [4, 4, 5, 5, 2, 3, 5, 5, 5, 5, 3, 4, 4, 5, 4, 4, 4, 3, 3, 4, 4, 4, 3, 5, 4, 4, 5, 4, 5, 5, 5, 5, 5, 4, 4, 4, 3, 4, 5, 4, 4, 5, 5, 4, 4, 4, 4, 4, 5, 5, 4]
HM2= [4, 4, 5, 5, 3, 3, 5, 5, 5, 5, 4, 4, 4, 5, 4, 4, 4, 3, 3, 4, 4, 4, 3, 5, 3, 4, 5, 5, 5, 5, 4, 5, 3, 4, 4, 4, 3, 4, 5, 4, 4, 5, 5, 4, 4, 4, 4, 5, 5, 5, 4]
HM3= [4, 4, 5, 5, 3, 4, 5, 3, 5, 5, 3, 4, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 3, 5, 3, 4, 4, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 5, 5, 4, 5, 5, 5, 4, 4, 4, 4, 5, 5, 5, 4]
PV1= [4, 3, 3, 4, 3, 1, 3, 3, 5, 5, 4, 3, 4, 4, 3, 4, 4, 2, 3, 4, 3, 4, 3, 5, 4, 4, 2, 4, 5, 3, 3, 5, 3, 3, 3, 3, 3, 2, 3, 4, 3, 3, 5, 3, 4, 3, 2, 4, 5, 4, 3]
PV2= [4, 3, 3, 3, 3, 1, 3, 4, 5, 4, 3, 3, 3, 4, 3, 4, 4, 2, 3, 4, 3, 4, 3, 5, 3, 4, 2, 4, 5, 5, 3, 5, 4, 3, 3, 3, 3, 3, 3, 4, 3, 4, 5, 3, 4, 4, 2, 4, 5, 4, 3]
PV3= [4, 3, 2, 3, 3, 3, 3, 4, 5, 5, 4, 4, 3, 4, 3, 4, 4, 3, 3, 4, 3, 4, 3, 5, 5, 4, 2, 5, 5, 3, 4, 5, 3, 3, 3, 3, 3, 3, 3, 5, 4, 4, 5, 3, 4, 4, 4, 5, 5, 5, 3]
HT1= [4, 3, 2, 2, 1, 1, 2, 2, 5, 5, 4, 4, 3, 5, 2, 4, 4, 2, 3, 4, 1, 4, 3, 5, 5, 4, 3, 5, 2, 2, 3, 5, 3, 2, 3, 4, 3, 2, 3, 4, 3, 5, 5, 1, 2, 4, 2, 4, 5, 5, 2]
HT2= [5, 3, 2, 2, 1, 1, 1, 2, 5, 5, 2, 2, 2, 5, 2, 4, 4, 1, 3, 2, 1, 3, 2, 5, 2, 3, 1, 3, 1, 2, 4, 5, 3, 2, 3, 2, 4, 2, 3, 4, 1, 3, 5, 1, 2, 3, 2, 3, 5, 4, 3]
HT3= [4, 3, 1, 1, 1, 1, 1, 2, 5, 5, 4, 2, 3, 5, 3, 4, 4, 2, 3, 3, 1, 4, 2, 5, 2, 4, 2, 4, 2, 2, 2, 5, 3, 3, 3, 2, 2, 3, 3, 4, 3, 3, 5, 1, 2, 4, 2, 3, 5, 5, 2]
BI1= [4, 3, 2, 2, 1, 1, 4, 4, 5, 5, 4, 4, 4, 5, 3, 4, 4, 3, 3, 4, 1, 4, 3, 5, 5, 4, 4, 5, 3, 5, 3, 5, 4, 3, 4, 4, 4, 3, 3, 4, 4, 3, 5, 2, 3, 4, 4, 4, 5, 5, 3]
BI2= [4, 3, 3, 1, 1, 1, 2, 3, 5, 5, 4, 4, 4, 5, 3, 4, 4, 2, 3, 4, 1, 3, 3, 5, 5, 4, 4, 4, 2, 4, 2, 5, 4, 3, 3, 4, 3, 2, 3, 4, 4, 4, 5, 2, 3, 4, 4, 4, 5, 5, 3]
BI3= [4, 3, 2, 2, 1, 1, 3, 3, 5, 5, 4, 4, 5, 5, 3, 4, 4, 2, 3, 4, 1, 3, 3, 5, 5, 4, 4, 5, 3, 5, 4, 5, 4, 3, 4, 4, 3, 2, 3, 4, 3, 4, 5, 2, 4, 4, 4, 5, 5, 5, 3]


# 定義各變量的分數
pe_scores = [PE1, PE2, PE3]
ee_scores = [EE1, EE2, EE3, EE4]
si_scores = [SI1, SI2, SI3]
fc_scores = [FC1, FC2, FC3,FC4]
hm_scores = [HM1,HM2,HM3]
pv_scores = [PV1, PV2, PV3]
ht_scores = [HT1, HT2, HT3]
bi_scores = [BI1, BI2, BI3]

# 合併相同構念的題目
pe_avg = pd.Series(sum(pe_scores, [])).rename("PE")
ee_avg = pd.Series(sum(ee_scores, [])).rename("EE")
si_avg = pd.Series(sum(si_scores, [])).rename("SI")
fc_avg = pd.Series(sum(fc_scores, [])).rename("FC")
hm_avg = pd.Series(sum(hm_scores, [])).rename("HM")
pv_avg = pd.Series(sum(pv_scores, [])).rename("PV")
ht_avg = pd.Series(sum(ht_scores, [])).rename("HT")
bi_avg = pd.Series(sum(bi_scores, [])).rename("BI")

# 將合併後的數據放入DataFrame
merged_data = pd.concat([pe_avg, ee_avg, si_avg, fc_avg, hm_avg, pv_avg, ht_avg, bi_avg], axis=1)

# 計算相關係數矩陣
correlation_matrix = merged_data.corr()

# 繪製熱圖
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', vmin=-1, vmax=1)
plt.title('Pearson Correlation Heatmap')
plt.show()

print("Correlation Matrix:")
print(correlation_matrix)
